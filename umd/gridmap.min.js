!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=15)}([function(t,e,n){"use strict";function r(t,e,n,o){if(!(this instanceof r))return new r(t,e,n,o);var i,a,s;t.x?(n=t.w,o=t.h,e=t.y,0!==t.w&&!t.w&&t.x2?(n=t.x2-t.x,o=t.y2-t.y):(n=t.w,o=t.h),t=t.x,i=t+n,a=e+o,s=!(o+n)):(i=t+n,a=e+o,s=!(o+n)),this.x1=this.x=function(){return t},this.y1=this.y=function(){return e},this.x2=function(){return i},this.y2=function(){return a},this.w=function(){return n},this.h=function(){return o},this.p=function(){return s},this.overlap=function(n){return s||n.p()?t<=n.x2()&&i>=n.x()&&e<=n.y2()&&a>=n.y():t<n.x2()&&i>n.x()&&e<n.y2()&&a>n.y()},this.expand=function(r){var s,u,h=r.x(),c=r.y(),l=r.x2(),f=r.y2();return s=t>h?h:t,u=e>c?c:e,n=i>l?i-s:l-s,o=a>f?a-u:f-u,t=s,e=u,this}}r.overlapRectangle=function(t,e){return 0===t.h&&0===t.w||0===e.h&&0===e.w?t.x<=e.x+e.w&&t.x+t.w>=e.x&&t.y<=e.y+e.h&&t.y+t.h>=e.y:t.x<e.x+e.w&&t.x+t.w>e.x&&t.y<e.y+e.h&&t.y+t.h>e.y},r.containsRectangle=function(t,e){return t.x+t.w<=e.x+e.w&&t.x>=e.x&&t.y+t.h<=e.y+e.h&&t.y>=e.y},r.expandRectangle=function(t,e){var n,r,o=t.x+t.w,i=e.x+e.w,a=t.y+t.h,s=e.y+e.h;return n=t.x>e.x?e.x:t.x,r=t.y>e.y?e.y:t.y,t.w=o>i?o-n:i-n,t.h=a>s?a-r:s-r,t.x=n,t.y=r,t},r.makeMBR=function(t,e){if(!t.length)return{x:0,y:0,w:0,h:0};(e=e||{}).x=t[0].x,e.y=t[0].y,e.w=t[0].w,e.h=t[0].h;for(var n=1,o=t.length;n<o;n++)r.expandRectangle(e,t[n]);return e},r.squarifiedRatio=function(t,e,n){var r=(t+e)/2,o=t*e;return o*n/(o/(r*r))},t.exports=r},function(t,e,n){"use strict";t.exports=function(t,e,n){var o=t*e,i=r*t,a=i-(i-t),s=t-a,u=r*e,h=u-(u-e),c=e-h,l=s*c-(o-a*h-s*h-a*c);if(n)return n[0]=l,n[1]=o,n;return[l,o]};var r=+(Math.pow(2,27)+1)},function(t,e,n){"use strict";ymaps.modules.define("HotspotObjectSourceBrowser",["util.defineClass","util.extend","hotspot.ObjectSource"],function(t,e,n,r){var o=function t(e,r){t.superclass.constructor.call(this,"",n({},r)),this.options.set("getHotspotsForTile",r.getHotspotsForTile)};e(o,r,{requestObjects:function(t,e,n,r){var o={data:{type:"FeatureCollection",features:this.options.get("getHotspotsForTile")(e,n)}};this.parseResponse(t,o,r,e,n)}}),t(o)})},function(t,e,n){"use strict";t.exports=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,o=t-(n-r)+(e-r);if(o)return[o,n];return[n]}(t[0],-e[0]);var o,i,a=new Array(n+r),s=0,u=0,h=0,c=Math.abs,l=t[u],f=c(l),p=-e[h],g=c(p);f<g?(i=l,(u+=1)<n&&(l=t[u],f=c(l))):(i=p,(h+=1)<r&&(p=-e[h],g=c(p)));u<n&&f<g||h>=r?(o=l,(u+=1)<n&&(l=t[u],f=c(l))):(o=p,(h+=1)<r&&(p=-e[h],g=c(p)));var y,d,x=o+i,v=x-o,b=i-v,w=b,m=x;for(;u<n&&h<r;)f<g?(o=l,(u+=1)<n&&(l=t[u],f=c(l))):(o=p,(h+=1)<r&&(p=-e[h],g=c(p))),(b=(i=w)-(v=(x=o+i)-o))&&(a[s++]=b),w=m-((y=m+x)-(d=y-m))+(x-d),m=y;for(;u<n;)(b=(i=w)-(v=(x=(o=l)+i)-o))&&(a[s++]=b),w=m-((y=m+x)-(d=y-m))+(x-d),m=y,(u+=1)<n&&(l=t[u]);for(;h<r;)(b=(i=w)-(v=(x=(o=p)+i)-o))&&(a[s++]=b),w=m-((y=m+x)-(d=y-m))+(x-d),m=y,(h+=1)<r&&(p=-e[h]);w&&(a[s++]=w);m&&(a[s++]=m);s||(a[s++]=0);return a.length=s,a}},function(t,e,n){"use strict";t.exports=function(t,e,n){var r=t+e,o=r-t,i=e-o,a=t-(r-o);if(n)return n[0]=a+i,n[1]=r,n;return[a+i,r]}},function(t,e,n){"use strict";var r=n(1),o=n(4);t.exports=function(t,e){var n=t.length;if(1===n){var i=r(t[0],e);return i[0]?i:[i[1]]}var a=new Array(2*n),s=[.1,.1],u=[.1,.1],h=0;r(t[0],e,s),s[0]&&(a[h++]=s[0]);for(var c=1;c<n;++c){r(t[c],e,u);var l=s[1];o(l,u[0],s),s[0]&&(a[h++]=s[0]);var f=u[1],p=s[1],g=f+p,y=g-f,d=p-y;s[1]=g,d&&(a[h++]=d)}s[1]&&(a[h++]=s[1]);0===h&&(a[h++]=0);return a.length=h,a}},function(t,e,n){"use strict";t.exports=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,o=t-(n-r)+(e-r);if(o)return[o,n];return[n]}(t[0],e[0]);var o,i,a=new Array(n+r),s=0,u=0,h=0,c=Math.abs,l=t[u],f=c(l),p=e[h],g=c(p);f<g?(i=l,(u+=1)<n&&(l=t[u],f=c(l))):(i=p,(h+=1)<r&&(p=e[h],g=c(p)));u<n&&f<g||h>=r?(o=l,(u+=1)<n&&(l=t[u],f=c(l))):(o=p,(h+=1)<r&&(p=e[h],g=c(p)));var y,d,x=o+i,v=x-o,b=i-v,w=b,m=x;for(;u<n&&h<r;)f<g?(o=l,(u+=1)<n&&(l=t[u],f=c(l))):(o=p,(h+=1)<r&&(p=e[h],g=c(p))),(b=(i=w)-(v=(x=o+i)-o))&&(a[s++]=b),w=m-((y=m+x)-(d=y-m))+(x-d),m=y;for(;u<n;)(b=(i=w)-(v=(x=(o=l)+i)-o))&&(a[s++]=b),w=m-((y=m+x)-(d=y-m))+(x-d),m=y,(u+=1)<n&&(l=t[u]);for(;h<r;)(b=(i=w)-(v=(x=(o=p)+i)-o))&&(a[s++]=b),w=m-((y=m+x)-(d=y-m))+(x-d),m=y,(h+=1)<r&&(p=e[h]);w&&(a[s++]=w);m&&(a[s++]=m);s||(a[s++]=0);return a.length=s,a}},function(t,e,n){"use strict";var r=n(1),o=n(6),i=n(5),a=n(3),s=5;function u(t,e){for(var n=new Array(t.length-1),r=1;r<t.length;++r)for(var o=n[r-1]=new Array(t.length-1),i=0,a=0;i<t.length;++i)i!==e&&(o[a++]=t[r][i]);return n}function h(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",h(t.slice(0,e)),",",h(t.slice(e)),")"].join("")}function c(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var e=[],n=0;n<t.length;++n)e.push(["scale(",h(c(u(t,n))),",",(r=n,1&r?"-":""),t[0][n],")"].join(""));return e;var r}function l(t){for(var e=[],n=[],s=function(t){for(var e=new Array(t),n=0;n<t;++n){e[n]=new Array(t);for(var r=0;r<t;++r)e[n][r]=["m",r,"[",t-n-1,"]"].join("")}return e}(t),l=[],f=0;f<t;++f)0==(1&f)?e.push.apply(e,c(u(s,f))):n.push.apply(n,c(u(s,f))),l.push("m"+f);var p=h(e),g=h(n),y="orientation"+t+"Exact",d=["function ",y,"(",l.join(),"){var p=",p,",n=",g,",d=sub(p,n);return d[d.length-1];};return ",y].join("");return new Function("sum","prod","scale","sub",d)(o,r,i,a)}var f=l(3),p=l(4),g=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var r,o=(t[1]-n[1])*(e[0]-n[0]),i=(t[0]-n[0])*(e[1]-n[1]),a=o-i;if(o>0){if(i<=0)return a;r=o+i}else{if(!(o<0))return a;if(i>=0)return a;r=-(o+i)}var s=3.3306690738754716e-16*r;return a>=s||a<=-s?a:f(t,e,n)},function(t,e,n,r){var o=t[0]-r[0],i=e[0]-r[0],a=n[0]-r[0],s=t[1]-r[1],u=e[1]-r[1],h=n[1]-r[1],c=t[2]-r[2],l=e[2]-r[2],f=n[2]-r[2],g=i*h,y=a*u,d=a*s,x=o*h,v=o*u,b=i*s,w=c*(g-y)+l*(d-x)+f*(v-b),m=7.771561172376103e-16*((Math.abs(g)+Math.abs(y))*Math.abs(c)+(Math.abs(d)+Math.abs(x))*Math.abs(l)+(Math.abs(v)+Math.abs(b))*Math.abs(f));return w>m||-w>m?w:p(t,e,n,r)}];!function(){for(;g.length<=s;)g.push(l(g.length));for(var e=[],n=["slow"],r=0;r<=s;++r)e.push("a"+r),n.push("o"+r);var o=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(r=2;r<=s;++r)o.push("case ",r,":return o",r,"(",e.slice(0,r).join(),");");o.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),n.push(o.join(""));var i=Function.apply(void 0,n);for(t.exports=i.apply(void 0,[function(t){var e=g[t.length];return e||(e=g[t.length]=l(t.length)),e.apply(void 0,t)}].concat(g)),r=0;r<=s;++r)t.exports[r]=g[r]}()},function(t,e,n){t.exports=function(t,e){for(var n=e[0],o=e[1],i=t.length,a=1,s=i,u=0,h=i-1;u<s;h=u++){var c=t[u],l=t[h],f=c[1],p=l[1];if(p<f){if(p<o&&o<f){var g=r(c,l,e);if(0===g)return 0;a^=0<g|0}else if(o===f){var y=t[(u+1)%i],d=y[1];if(f<d){var g=r(c,l,e);if(0===g)return 0;a^=0<g|0}}}else if(f<p){if(f<o&&o<p){var g=r(c,l,e);if(0===g)return 0;a^=g<0|0}else if(o===f){var y=t[(u+1)%i],d=y[1];if(d<f){var g=r(c,l,e);if(0===g)return 0;a^=g<0|0}}}else if(o===f){var x=Math.min(c[0],l[0]),v=Math.max(c[0],l[0]);if(0===u){for(;h>0;){var b=(h+i-1)%i,w=t[b];if(w[1]!==o)break;var m=w[0];x=Math.min(x,m),v=Math.max(v,m),h=b}if(0===h)return x<=n&&n<=v?0:1;s=h+1}for(var _=t[(h+i-1)%i][1];u+1<s;){var w=t[u+1];if(w[1]!==o)break;var m=w[0];x=Math.min(x,m),v=Math.max(v,m),u+=1}if(x<=n&&n<=v)return 0;var M=t[(u+1)%i][1];n<x&&_<o!=M<o&&(a^=1)}}return 2*a-1};var r=n(7)},function(t,e,n){"use strict";var r=n(0),o=function(t,e){if(e&&e.bbox)return{leaf:e,x:e.bbox[0],y:e.bbox[1],w:e.bbox[2]-e.bbox[0],h:e.bbox[3]-e.bbox[1]};for(var n=t.length,r=0,o=new Array(n);r<n;)o[r]=[t[r][0],t[r][1]],r++;var i=o[0];n=o.length,r=1;for(var a={min:[].concat(i),max:[].concat(i)};r<n;)o[r][0]<a.min[0]?a.min[0]=o[r][0]:o[r][0]>a.max[0]&&(a.max[0]=o[r][0]),o[r][1]<a.min[1]?a.min[1]=o[r][1]:o[r][1]>a.max[1]&&(a.max[1]=o[r][1]),r++;var s={x:a.min[0],y:a.min[1],w:a.max[0]-a.min[0],h:a.max[1]-a.min[1]};return e&&(s.leaf=e),s},i={point:function(t,e){return e.insertSubtree({x:t.geometry.coordinates[0],y:t.geometry.coordinates[1],w:0,h:0,leaf:t},e.root)},multiPointLineString:function(t,e){return e.insertSubtree(o(t.geometry.coordinates,t),e.root)},multiLineStringPolygon:function(t,e){return e.insertSubtree(o(Array.prototype.concat.apply([],t.geometry.coordinates),t),e.root)},multiPolygon:function(t,e){return e.insertSubtree(o(Array.prototype.concat.apply([],Array.prototype.concat.apply([],t.geometry.coordinates)),t),e.root)},makeRec:function(t){return r(t.x,t.y,t.w,t.h)},geometryCollection:function(t,e){if(t.bbox)return e.insertSubtree({leaf:t,x:t.bbox[0],y:t.bbox[1],w:t.bbox[2]-t.bbox[0],h:t.bbox[3]-t.bbox[1]},e.root);for(var n,r=t.geometry.geometries,a=0,s=r.length,u=[];a<s;){switch((n=r[a]).type){case"Point":u.push(i.makeRec({x:n.coordinates[0],y:n.coordinates[1],w:0,h:0}));break;case"MultiPoint":case"LineString":u.push(i.makeRec(o(n.coordinates)));break;case"MultiLineString":case"Polygon":u.push(i.makeRec(o(Array.prototype.concat.apply([],n.coordinates))));break;case"MultiPolygon":u.push(i.makeRec(o(Array.prototype.concat.apply([],Array.prototype.concat.apply([],n.coordinates)))));break;case"GeometryCollection":s=(r=r.concat(n.geometries)).length}a++}var h=u[0];for(a=1,s=u.length;a<s;)h.expand(u[a]),a++;return e.insertSubtree({leaf:t,x:h.x(),y:h.y(),h:h.h(),w:h.w()},e.root)}};e.geoJSON=function(t){var e,n;if(Array.isArray(t))e=t.slice();else if(t.features&&Array.isArray(t.features))e=t.features.slice();else{if(!(t instanceof Object))throw"this isn't what we're looking for";e=[t]}for(var r=e.length,o=0;o<r;){if("Feature"===(n=e[o]).type)switch(n.geometry.type){case"Point":i.point(n,this);break;case"MultiPoint":case"LineString":i.multiPointLineString(n,this);break;case"MultiLineString":case"Polygon":i.multiLineStringPolygon(n,this);break;case"MultiPolygon":i.multiPolygon(n,this);break;case"GeometryCollection":i.geometryCollection(n,this)}o++}},e.bbox=function(){var t,e,n,r;switch(arguments.length){case 1:t=arguments[0][0][0],e=arguments[0][0][1],n=arguments[0][1][0],r=arguments[0][1][1];break;case 2:t=arguments[0][0],e=arguments[0][1],n=arguments[1][0],r=arguments[1][1];break;case 4:t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3]}return this.search({x:t,y:e,w:n-t,h:r-e})}},function(t,e,n){"use strict";var r=n(0);function o(t){if(!(this instanceof o))return new o(t);var e=3,n=6;isNaN(t)||(e=Math.floor(t/2),n=t);var i={x:0,y:0,w:0,h:0,id:"root",nodes:[]};this.root=i;var a=function(t){for(var e,n=t.slice(),r=[];n.length;)(e=n.pop()).nodes?n=n.concat(e.nodes):e.leaf&&r.push(e);return r},s=function(t,n,o){var i,s,u,h=[],c=[],p=[];if(!t||!r.overlapRectangle(t,o))return p;var g={x:t.x,y:t.y,w:t.w,h:t.h,target:n};for(c.push(o.nodes.length),h.push(o);h.length>0;){if(i=h.pop(),s=c.pop()-1,"target"in g)for(;s>=0;){if(u=i.nodes[s],r.overlapRectangle(g,u)){if(g.target&&"leaf"in u&&u.leaf===g.target||!g.target&&("leaf"in u||r.containsRectangle(u,g))){p="nodes"in u?a(i.nodes.splice(s,1)):i.nodes.splice(s,1),r.makeMBR(i.nodes,i),delete g.target;break}"nodes"in u&&(0,c.push(s),h.push(i),i=u,s=u.nodes.length)}s--}else if("nodes"in g){i.nodes.splice(s+1,1),i.nodes.length>0&&r.makeMBR(i.nodes,i);for(var y=0;y<g.nodes.length;y++)f(g.nodes[y],i);g.nodes=[],0===h.length&&i.nodes.length<=1?(g.nodes=l(i,!0,g.nodes,i),i.nodes=[],h.push(i),c.push(1)):h.length>0&&i.nodes.length<e?(g.nodes=l(i,!0,g.nodes,i),i.nodes=[]):delete g.nodes}else r.makeMBR(i.nodes,i);1}return p},u=function(t){for(var e=c(t);t.length>0;)h(t,e[0],e[1]);return e},h=function(t,n,o){for(var i,a,s,u=r.squarifiedRatio(n.w,n.h,n.nodes.length+1),h=r.squarifiedRatio(o.w,o.h,o.nodes.length+1),c=t.length-1;c>=0;c--){var l=t[c],f={};f.x=Math.min(n.x,l.x),f.y=Math.min(n.y,l.y),f.w=Math.max(n.x+n.w,l.x+l.w)-f.x,f.h=Math.max(n.y+n.h,l.y+l.h)-f.y;var p=Math.abs(r.squarifiedRatio(f.w,f.h,n.nodes.length+2)-u),g={};g.x=Math.min(o.x,l.x),g.y=Math.min(o.y,l.y),g.w=Math.max(o.x+o.w,l.x+l.w)-g.x,g.h=Math.max(o.y+o.h,l.y+l.h)-g.y;var y=Math.abs(r.squarifiedRatio(g.w,g.h,o.nodes.length+2)-h);(!a||!i||Math.abs(y-p)<i)&&(a=c,i=Math.abs(y-p),s=y<p?o:n)}var d=t.splice(a,1)[0];n.nodes.length+t.length+1<=e?(n.nodes.push(d),r.expandRectangle(n,d)):o.nodes.length+t.length+1<=e?(o.nodes.push(d),r.expandRectangle(o,d)):(s.nodes.push(d),r.expandRectangle(s,d))},c=function(t){for(var e,n,r=t.length-1,o=0,i=t.length-1,a=0,s=t.length-2;s>=0;s--){var u=t[s];u.x>t[o].x?o=s:u.x+u.w<t[r].x+t[r].w&&(r=s),u.y>t[a].y?a=s:u.y+u.h<t[i].y+t[i].h&&(i=s)}return Math.abs(t[r].x+t[r].w-t[o].x)>Math.abs(t[i].y+t[i].h-t[a].y)?r>o?(e=t.splice(r,1)[0],n=t.splice(o,1)[0]):(n=t.splice(o,1)[0],e=t.splice(r,1)[0]):i>a?(e=t.splice(i,1)[0],n=t.splice(a,1)[0]):(n=t.splice(a,1)[0],e=t.splice(i,1)[0]),[{x:e.x,y:e.y,w:e.w,h:e.h,nodes:[e]},{x:n.x,y:n.y,w:n.w,h:n.h,nodes:[n]}]},l=function(t,e,n,o){var i=[];if(!r.overlapRectangle(t,o))return n;for(i.push(o.nodes);i.length>0;)for(var a=i.pop(),s=a.length-1;s>=0;s--){var u=a[s];r.overlapRectangle(t,u)&&("nodes"in u?i.push(u.nodes):"leaf"in u&&(e?n.push(u):n.push(u.leaf)))}return n},f=function(t,e){var o;if(0===e.nodes.length)return e.x=t.x,e.y=t.y,e.w=t.w,e.h=t.h,void e.nodes.push(t);for(var i,a=function(t,e){var n,o=-1,i=[],a=!0;i.push(e);for(var s=e.nodes;a||-1!==o;){a?a=!1:(i.push(s[o]),s=s[o].nodes,o=-1);for(var u=s.length-1;u>=0;u--){var h=s[u];if("leaf"in h){o=-1;break}var c=r.squarifiedRatio(h.w,h.h,h.nodes.length+1),l=Math.max(h.x+h.w,t.x+t.w)-Math.min(h.x,t.x),f=Math.max(h.y+h.h,t.y+t.h)-Math.min(h.y,t.y),p=r.squarifiedRatio(l,f,h.nodes.length+2);(o<0||Math.abs(p-c)<n)&&(n=Math.abs(p-c),o=u)}}return i}(t,e),s=t;a.length>0;){if(o&&"nodes"in o&&0===o.nodes.length){i=o,o=a.pop();for(var h=0;h<o.nodes.length;h++)if(o.nodes[h]===i||0===o.nodes[h].nodes.length){o.nodes.splice(h,1);break}}else o=a.pop();if("leaf"in s||"nodes"in s||Array.isArray(s)){if(Array.isArray(s)){for(var c=0;c<s.length;c++)r.expandRectangle(o,s[c]);o.nodes=o.nodes.concat(s)}else r.expandRectangle(o,s),o.nodes.push(s);if(o.nodes.length<=n)s={x:o.x,y:o.y,w:o.w,h:o.h};else{var l=u(o.nodes);s=l,a.length<1&&(o.nodes.push(l[0]),a.push(o),s=l[1])}}else r.expandRectangle(o,s),s={x:o.x,y:o.y,w:o.w,h:o.h}}};this.insertSubtree=f,this.getTree=function(){return i},this.setTree=function(t,e){return e||(e=i),r=t,(n=e).nodes=r.nodes,n.x=r.x,n.y=r.y,n.w=r.w,n.h=r.h,n;var n,r},this.search=function(t,e,n){return l(t,e,n=n||[],i)};this.remove=function(t,e){return e&&"function"!=typeof e?function(t,e){return s(t,e,i)}(t,e):function(t){for(var e,n=1,r=[];n>0;)n=(e=s(t,!1,i)).length,r=r.concat(e);return r}(t)},this.insert=function(t,e){return f({x:t.x,y:t.y,w:t.w,h:t.h,leaf:e},i)}}o.prototype.toJSON=function(t){return JSON.stringify(this.root,!1,t)},o.fromJSON=function(t){var e=new o;return e.setTree(JSON.parse(t)),e},t.exports=o,"function"!=typeof Array.isArray&&(Array.isArray=function(t){return"object"==typeof t&&"[object Array]"==={}.toString.call(t)})},function(t,e,n){"use strict";var r=n(10),o=n(9);r.prototype.bbox=o.bbox,r.prototype.geoJSON=o.geoJSON,r.Rectangle=n(0),t.exports=r},function(t,e,n){"use strict";e.__esModule=!0;var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.side=e}return t.prototype.getCentersForTile=function(t,e,n){for(var r=this.side/n,o=this.side/n,i=[t[0]*e,t[1]*e],a=Math.ceil(i[0]/r)-1,s=Math.ceil(i[1]/o)-1,u=[],h=[a*r-i[0],s*o-i[1]],c=h[0],l=h[1];l<e+1*o;){for(;c<e+1*r;)u.push([c,l]),c+=r;l+=o,c=h[0]}return u},t.prototype.getPixelVerticesForTile=function(t,e){var n=t[0],r=t[1],o=this.side/e,i=n-o/2,a=r-o/2;return[[i,a],[i,a+o],[i+o,a+o],[i+o,a]]},t.prototype.getBBox=function(t,e,n){var r=t[0],o=t[1],i=this.side/n,a=o-i/2;return{x:(r-i/2+e[0])*n,y:(a+e[1])*n,w:i*n,h:i*n}},t}();e.default=r},function(t,e,n){"use strict";e.__esModule=!0,e.sin=function(t){return Math.sin(Math.PI*t/180)},e.cos=function(t){return Math.cos(Math.PI*t/180)}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(13);var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.R=e}return t.prototype.getCentersForTile=function(t,e,n){for(var o=this.R/n,i=(0,r.sin)(60)*o,a=1.5*o,s=2*i,u=[t[0]*e,t[1]*e],h=Math.ceil(u[0]/a)-1,c=Math.ceil(u[1]/s)-1,l=[],f=[h*a-u[0],c*s-u[1]],p=h,g=f[0],y=f[1];y<e+1*s;){for(;g<e+1*a;){var d=p%2==0?0:i;l.push([g,y+d]),p++,g+=a}y+=s,g=f[0],p=h}return l},t.prototype.getPixelVerticesForTile=function(t,e){var n=t[0],o=t[1],i=this.R/e;return[[(0,r.cos)(0),(0,r.sin)(0)],[(0,r.cos)(60),(0,r.sin)(60)],[(0,r.cos)(120),(0,r.sin)(120)],[(0,r.cos)(180),(0,r.sin)(180)],[(0,r.cos)(240),(0,r.sin)(240)],[(0,r.cos)(300),(0,r.sin)(300)],[(0,r.cos)(0),(0,r.sin)(0)]].map(function(t){var e=t[0],r=t[1];return[n+e*i,o+r*i]})},t.prototype.getBBox=function(t,e,n){var o=t[0],i=t[1],a=this.R/n,s=(0,r.sin)(60)*a;return{x:(o+e[0]-a)*n,y:(i+e[1]-s)*n,w:2*a*n,h:2*s*n}},t}();e.default=o},function(t,e,n){"use strict";var r=s(n(14)),o=s(n(12)),i=s(n(11)),a=s(n(8));function s(t){return t&&t.__esModule?t:{default:t}}n(2),ymaps.modules.define("Gridmap",["Layer","util.hd","util.defineClass","util.extend","HotspotObjectSourceBrowser","option.Manager"],function(t,e,n,s,u,h,c){var l=n.getPixelRatio();t(function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var a=new c({map:void 0,debug:!1,gridType:void 0,gridHexagonRadius:15,gridSquareSidelength:15,filterEmptyShapes:!1,emptyShapesColor:"rgba(255,255,255, 0)",shapeColor:function(t){for(var e=[200,80,20,10,5],n=["rgba(74,20,140, 0.8)","rgba(106,27,154, 0.8)","rgba(123,31,162, 0.8)","rgba(157,101,171, 0.8)","rgba(165,135,173, 0.8)"],r=t.length,o=n[e.length-1],i=0;i<e.length;i++)if(r<=e[i]&&r>e[i+1]){o=n[i];break}return o},strokeColor:"#666",strokeWidth:1,getHotspotProps:function(t){return{balloonContentBody:"The number of points is "+t.length,balloonContentHeader:"Object's data",balloonContentFooter:"Powered by Gridmap",hintContent:""+t.length}},hotspotLayerOptions:{zIndex:201,cursor:"pointer"}});if(this._options=new c(n,a),!this._options.get("map"))throw new Error('option "map" is required');switch(this._projection=this._options.get("map").options.get("projection"),this._data=e.features,this._canvas=document.createElement("canvas"),this._canvas.width=256*l,this._canvas.height=256*l,this._tileSize=256,this._context=this._canvas.getContext("2d"),this._buildTree(),this._options.get("gridType")){case"hexagon":this._shape=new r.default(this._options.get("gridHexagonRadius"));break;case"square":this._shape=new o.default(this._options.get("gridSquareSidelength"));break;default:throw new Error("Unknown grid type")}var s=function(t,e){return i._getDataURL(t,e)};this.layer=new ymaps.Layer(s,{tileTransparent:!0}),this.objSource=new h(s,{getHotspotsForTile:function(t,e){return i._getHotspotsForTile(t,e)}}),this.hotspotLayer=new ymaps.hotspot.Layer(this.objSource,this._options.get("hotspotLayerOptions")),this._options.get("map").layers.add(this.hotspotLayer),this._options.get("map").layers.add(this.layer),this.events=this.hotspotLayer.events}return t.prototype._buildTree=function(){var t=this;this._tree=new i.default,this._treeZoom=this._options.get("map").getZoom(),this._data.forEach(function(e){var n=t._projection.toGlobalPixels(e.geometry.coordinates,t._treeZoom),r=n[0],o=n[1],i={feature:e,pixelCoords:[r,o]};t._tree.insert({x:r,y:o,w:0,h:0},i)})},t.prototype._getScale=function(){return Math.pow(2,this._treeZoom-this._options.get("map").getZoom())},t.prototype._getPointsForShape=function(t,e,n){var r=this._getScale(),o=e.map(function(t){var e=t[0],o=t[1];return[(e+n[0])*r,(o+n[1])*r]}),i=this._shape.getBBox(t,n,r);return this._tree.search(i).filter(function(t){var e=t.pixelCoords;return(0,a.default)(o,e)<=0})},t.prototype._getTileOffset=function(t,e){return[t[0]*e,t[1]*e]},t.prototype._getHotspotsForTile=function(t){var e=this,n=[],r=this._getScale(),o=this._shape.getCentersForTile(t,this._tileSize,r),i=this._getTileOffset(t,this._tileSize),a=this._options.get("getHotspotProps");return o.forEach(function(t){var o=t[0],s=t[1],u=e._shape.getPixelVerticesForTile([o,s],r),h=e._getPointsForShape([o,s],u,i);if(h.length>0){var c=u.map(function(t){var n=t[0],r=t[1];return e._projection.fromGlobalPixels([n+i[0],r+i[1]],e._options.get("map").getZoom())}),l="function"==typeof a?a(h):{},f={points:h,objectGeometry:c,HotspotMetaData:{id:JSON.stringify(h),RenderedGeometry:{type:"Polygon",coordinates:[u]}}},p=Object.assign({},l,f);n.push({type:"Feature",properties:p})}}),n},t.prototype._drawTile=function(t){var e=this,n=this._getScale(),r=this._shape.getCentersForTile(t,this._tileSize,n),o=this._getTileOffset(t,this._tileSize);this._context.clearRect(0,0,this._canvas.width,this._canvas.height),r.forEach(function(t){var r=t[0],i=t[1],a=e._shape.getPixelVerticesForTile([r,i],n),s=e._getPointsForShape([r,i],a,o),u=s.length;e._options.get("filterEmptyShapes")&&0===u||(e._context.beginPath(),a.forEach(function(t,n){var r=t[0],o=t[1];0===n?e._context.moveTo(r*l,o*l):e._context.lineTo(r*l,o*l)}),e._context.fillStyle=u>0?e._options.get("shapeColor")(s):e._options.get("emptyShapesColor"),e._context.fill(),e._context.strokeStyle=e._options.get("strokeColor"),e._context.strokeWidth=e._options.get("strokeWidth"),e._context.stroke(),e._options.get("debug")&&(e._context.fillStyle="black",e._context.fillText(s.length,r,i)),e._context.closePath())})},t.prototype._getDataURL=function(t,e){return this._drawTile(t,e),this._canvas.toDataURL()},t}())})}]);